{
  "ignition": {
    "version": "3.2.0",
    "config": {
      "merge": [
        {
          "source": "data:;base64,${base_ign_b64}"
        }
      ]
    }
  },

  "storage": {
    "files": [
      {
        "path": "/etc/resolv.conf",
        "mode": 420,
        "overwrite": true,
        "contents": {
          "source": "data:text/plain;charset=utf-8,nameserver ${dns1}%0Anameserver ${dns2}"
        }
      }
    ]
  },

  "systemd": {
    "units": [
      {
        "name": "fix-dns.service",
        "enabled": true,
        "contents": "[Unit]\nDescription=Fix resolv.conf before kubelet\nBefore=kubelet.service\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/bash -c 'echo nameserver ${dns1} > /etc/resolv.conf && echo nameserver ${dns2} >> /etc/resolv.conf'\n\n[Install]\nWantedBy=multi-user.target"
      }
    ]
  }
}